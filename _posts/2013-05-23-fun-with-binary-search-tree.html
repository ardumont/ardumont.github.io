---
layout: post
title: Binary Search Tree in Haskell
date: 2013-05-23
categories:
- haskell
- binary-search-tree
- functional-programming
author:
excerpt: Having fun implementing some binary search tree functions
---
<p>
In this post, following the same idea from the <a href="http://adumont.fr/blog/?p=1110">previous post about sets</a>, we will walk through some functions relative to <a href="https://en.wikipedia.org/wiki/Binary_search_tree">binary search trees</a>.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Definition</h2>
<div class="outline-text-2" id="text-1">
<p>
A <a href="https://en.wikipedia.org/wiki/Binary_search_tree">binary search tree</a> is a tree data structure with properties:
</p>
<ul class="org-ul">
<li>every node owns a value
</li>
<li>which is superior or equals to every value present in its left branch
</li>
<li>and strictly inferior to every value present in its right branch
</li>
<li>no duplicated node inside the tree
</li>
</ul>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #FBDE2D;">data</span> <span style="color: #D8FA3C;">Tree</span> a <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">|</span> <span style="color: #D8FA3C;">Node</span> a (<span style="color: #D8FA3C;">Tree</span> a) (<span style="color: #D8FA3C;">Tree</span> a) <span style="color: #FBDE2D;">deriving</span> (<span style="color: #D8FA3C;">Eq</span>, <span style="color: #D8FA3C;">Show</span>)
</pre>
</div>
</div>

<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">Example</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Given a small utility function to create leaf:
</p>
<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">leaf</span> <span style="color: #D8FA3C;">::</span> a <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Tree</span> a
<span style="color: #ff1493;">leaf</span> x <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">Node</span> x <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>
</pre>
</div>

<p>
we can create some samples to help in checking:
</p>
<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">t1</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Tree</span> <span style="color: #D8FA3C;">Int</span>
<span style="color: #ff1493;">t1</span> <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">Node</span> 4 (leaf 3) (<span style="color: #D8FA3C;">Node</span> 7 (leaf 5) (leaf 10))

<span style="color: #ff1493;">t2</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Tree</span> <span style="color: #D8FA3C;">Int</span>
<span style="color: #ff1493;">t2</span> <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">Node</span> 20 (<span style="color: #D8FA3C;">Node</span> 15 (<span style="color: #D8FA3C;">Node</span> 8 (leaf 7) (leaf 11)) (leaf 18))
             (<span style="color: #D8FA3C;">Node</span> 118
                     (<span style="color: #D8FA3C;">Node</span> 35 (leaf 33) (<span style="color: #D8FA3C;">Node</span> 49 <span style="color: #D8FA3C;">Empty</span> (leaf 60)))
                     (leaf 166))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">Pretty-print</h3>
<div class="outline-text-3" id="text-1-2">
<p>
To display a much more convenient display, a simple utility function could be used:
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">pp</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Show</span> a <span style="color: #D8FA3C;">=&gt;</span> <span style="color: #D8FA3C;">Tree</span> a <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">IO</span> <span style="color: #D8FA3C;">()</span>
<span style="color: #ff1493;">pp</span> <span style="color: #D8FA3C;">=</span> (mapM_ putStrLn) <span style="color: #D8FA3C;">.</span> treeIndent
  <span style="color: #FBDE2D;">where</span>
    treeIndent <span style="color: #D8FA3C;">Empty</span>          <span style="color: #D8FA3C;">=</span> [<span style="color: #61CE3C;">"-- /-"</span>]
    treeIndent (<span style="color: #D8FA3C;">Node</span> v lb rb) <span style="color: #D8FA3C;">=</span>
      [<span style="color: #61CE3C;">"--"</span> <span style="color: #D8FA3C;">++</span> (show v)] <span style="color: #D8FA3C;">++</span>
      map (<span style="color: #61CE3C;">"  |"</span> <span style="color: #D8FA3C;">++</span>) ls <span style="color: #D8FA3C;">++</span>
      (<span style="color: #61CE3C;">"  `"</span> <span style="color: #D8FA3C;">++</span> r) <span style="color: #D8FA3C;">:</span> map (<span style="color: #61CE3C;">"   "</span> <span style="color: #D8FA3C;">++</span>) rs
      <span style="color: #FBDE2D;">where</span>
        (r<span style="color: #D8FA3C;">:</span>rs) <span style="color: #D8FA3C;">=</span> treeIndent <span style="color: #D8FA3C;">$</span> rb
        ls     <span style="color: #D8FA3C;">=</span> treeIndent <span style="color: #D8FA3C;">$</span> lb
</pre>
</div>

<p>
Which simplifies the reading of trees:
</p>
<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> pp t1
<span style="color: #8B8989; font-style: italic;">--</span><span style="color: #8B8989; font-style: italic;">4</span>
  <span style="color: #D8FA3C;">|--</span>3
  <span style="color: #D8FA3C;">|</span>  <span style="color: #D8FA3C;">|--</span> <span style="color: #D8FA3C;">/-</span>
  <span style="color: #D8FA3C;">|</span>  `<span style="color: #8B8989; font-style: italic;">-- </span><span style="color: #8B8989; font-style: italic;">/-</span>
  `<span style="color: #8B8989; font-style: italic;">--</span><span style="color: #8B8989; font-style: italic;">7</span>
     <span style="color: #D8FA3C;">|--</span>5
     <span style="color: #D8FA3C;">|</span>  <span style="color: #D8FA3C;">|--</span> <span style="color: #D8FA3C;">/-</span>
     <span style="color: #D8FA3C;">|</span>  `<span style="color: #8B8989; font-style: italic;">-- </span><span style="color: #8B8989; font-style: italic;">/-</span>
     `<span style="color: #8B8989; font-style: italic;">--</span><span style="color: #8B8989; font-style: italic;">10</span>
        <span style="color: #D8FA3C;">|--</span> <span style="color: #D8FA3C;">/-</span>
        `<span style="color: #8B8989; font-style: italic;">-- </span><span style="color: #8B8989; font-style: italic;">/-</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> pp t2
<span style="color: #8B8989; font-style: italic;">--</span><span style="color: #8B8989; font-style: italic;">20</span>
  <span style="color: #D8FA3C;">|--</span>15
  <span style="color: #D8FA3C;">|</span>  <span style="color: #D8FA3C;">|--</span>8
  <span style="color: #D8FA3C;">|</span>  <span style="color: #D8FA3C;">|</span>  <span style="color: #D8FA3C;">|--</span>7
  <span style="color: #D8FA3C;">|</span>  <span style="color: #D8FA3C;">|</span>  <span style="color: #D8FA3C;">|</span>  <span style="color: #D8FA3C;">|--</span> <span style="color: #D8FA3C;">/-</span>
  <span style="color: #D8FA3C;">|</span>  <span style="color: #D8FA3C;">|</span>  <span style="color: #D8FA3C;">|</span>  `<span style="color: #8B8989; font-style: italic;">-- </span><span style="color: #8B8989; font-style: italic;">/-</span>
  <span style="color: #D8FA3C;">|</span>  <span style="color: #D8FA3C;">|</span>  `<span style="color: #8B8989; font-style: italic;">--</span><span style="color: #8B8989; font-style: italic;">11</span>
  <span style="color: #D8FA3C;">|</span>  <span style="color: #D8FA3C;">|</span>     <span style="color: #D8FA3C;">|--</span> <span style="color: #D8FA3C;">/-</span>
  <span style="color: #D8FA3C;">|</span>  <span style="color: #D8FA3C;">|</span>     `<span style="color: #8B8989; font-style: italic;">-- </span><span style="color: #8B8989; font-style: italic;">/-</span>
  <span style="color: #D8FA3C;">|</span>  `<span style="color: #8B8989; font-style: italic;">--</span><span style="color: #8B8989; font-style: italic;">18</span>
  <span style="color: #D8FA3C;">|</span>     <span style="color: #D8FA3C;">|--</span> <span style="color: #D8FA3C;">/-</span>
  <span style="color: #D8FA3C;">|</span>     `<span style="color: #8B8989; font-style: italic;">-- </span><span style="color: #8B8989; font-style: italic;">/-</span>
  `<span style="color: #8B8989; font-style: italic;">--</span><span style="color: #8B8989; font-style: italic;">118</span>
     <span style="color: #D8FA3C;">|--</span>35
     <span style="color: #D8FA3C;">|</span>  <span style="color: #D8FA3C;">|--</span>33
     <span style="color: #D8FA3C;">|</span>  <span style="color: #D8FA3C;">|</span>  <span style="color: #D8FA3C;">|--</span> <span style="color: #D8FA3C;">/-</span>
     <span style="color: #D8FA3C;">|</span>  <span style="color: #D8FA3C;">|</span>  `<span style="color: #8B8989; font-style: italic;">-- </span><span style="color: #8B8989; font-style: italic;">/-</span>
     <span style="color: #D8FA3C;">|</span>  `<span style="color: #8B8989; font-style: italic;">--</span><span style="color: #8B8989; font-style: italic;">49</span>
     <span style="color: #D8FA3C;">|</span>     <span style="color: #D8FA3C;">|--</span> <span style="color: #D8FA3C;">/-</span>
     <span style="color: #D8FA3C;">|</span>     `<span style="color: #8B8989; font-style: italic;">--</span><span style="color: #8B8989; font-style: italic;">60</span>
     <span style="color: #D8FA3C;">|</span>        <span style="color: #D8FA3C;">|--</span> <span style="color: #D8FA3C;">/-</span>
     <span style="color: #D8FA3C;">|</span>        `<span style="color: #8B8989; font-style: italic;">-- </span><span style="color: #8B8989; font-style: italic;">/-</span>
     `<span style="color: #8B8989; font-style: italic;">--</span><span style="color: #8B8989; font-style: italic;">166</span>
        <span style="color: #D8FA3C;">|--</span> <span style="color: #D8FA3C;">/-</span>
        `<span style="color: #8B8989; font-style: italic;">-- </span><span style="color: #8B8989; font-style: italic;">/-</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Functions</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">size</h3>
<div class="outline-text-3" id="text-2-1">
<p>
The size of the tree is taken to be the number of internal nodes (those with two children).
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">size</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Num</span> a <span style="color: #D8FA3C;">=&gt;</span> <span style="color: #D8FA3C;">Tree</span> b <span style="color: #D8FA3C;">-&gt;</span> a
<span style="color: #ff1493;">size</span> <span style="color: #D8FA3C;">Empty</span>        <span style="color: #D8FA3C;">=</span> 0
<span style="color: #ff1493;">size</span> (<span style="color: #D8FA3C;">Node</span> <span style="color: #FBDE2D;">_</span> l r) <span style="color: #D8FA3C;">=</span> 1 <span style="color: #D8FA3C;">+</span> size l <span style="color: #D8FA3C;">+</span> size r

<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> size t1
5
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> size t2
12
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">toList</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Returns an unsorted list of all values in the given Tree
A supplementary constraint is that we need to be able to rebuild the tree from the list.
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">toList</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Tree</span> a <span style="color: #D8FA3C;">-&gt;</span> [a]
<span style="color: #ff1493;">toList</span> <span style="color: #D8FA3C;">Empty</span>        <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">[]</span>
<span style="color: #ff1493;">toList</span> (<span style="color: #D8FA3C;">Node</span> x l r) <span style="color: #D8FA3C;">=</span> [x] <span style="color: #D8FA3C;">++</span> (toList l) <span style="color: #D8FA3C;">++</span> (toList r)

<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> toList t1
[4,3,7,5,10]
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> toList t2
[20,15,8,7,11,18,118,35,33,49,60,166]
</pre>
</div>

<p>
To check that we can rebuild the tree from the previous output, we will create a function fromList that creates a Tree from a list:
</p>
<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">fromList</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Ord</span> a <span style="color: #D8FA3C;">=&gt;</span> [a] <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Tree</span> a
<span style="color: #ff1493;">fromList</span> <span style="color: #D8FA3C;">[]</span>     <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">Empty</span>
<span style="color: #ff1493;">fromList</span> (x<span style="color: #D8FA3C;">:</span>xs) <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">Node</span> x (fromList lefts) (fromList rights)
                  <span style="color: #FBDE2D;">where</span> p      <span style="color: #D8FA3C;">=</span> (<span style="color: #D8FA3C;">&lt;=</span> x)
                        lefts  <span style="color: #D8FA3C;">=</span> takeWhile p xs
                        rights <span style="color: #D8FA3C;">=</span> dropWhile p xs
</pre>
</div>

<p>
We can now check that we can rebuild the tree from the list computed from the toList function.
</p>
<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> (fromList <span style="color: #D8FA3C;">.</span> toList) t1 <span style="color: #D8FA3C;">==</span> t1
<span style="color: #D8FA3C;">True</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> (fromList <span style="color: #D8FA3C;">.</span> toList) t1 <span style="color: #D8FA3C;">==</span> (leaf 1)
<span style="color: #D8FA3C;">False</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> (fromList <span style="color: #D8FA3C;">.</span> toList) t2 <span style="color: #D8FA3C;">==</span> t2
<span style="color: #D8FA3C;">True</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> (fromList <span style="color: #D8FA3C;">.</span> toList) t2 <span style="color: #D8FA3C;">==</span> (leaf 1)
<span style="color: #D8FA3C;">False</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3">toSortedList</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Returns a sorted list of all elements of the given Tree.
Note that we can't go back to the origin Tree.
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">toSortedList</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Tree</span> a <span style="color: #D8FA3C;">-&gt;</span> [a]
<span style="color: #ff1493;">toSortedList</span> <span style="color: #D8FA3C;">Empty</span>        <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">[]</span>
<span style="color: #ff1493;">toSortedList</span> (<span style="color: #D8FA3C;">Node</span> x l r) <span style="color: #D8FA3C;">=</span> toSortedList l <span style="color: #D8FA3C;">++</span> x <span style="color: #D8FA3C;">:</span> toSortedList r

<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> toSortedList t1
[3,4,5,7,10]
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> toSortedList t2
[7,8,11,15,18,20,33,35,49,60,118,166]
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4">smallValue</h3>
<div class="outline-text-3" id="text-2-4">
<p>
Returns the smallest value in the given Tree.
Given the nature of the tree, as long as the tree has left branches, we continue the computation from the left branch.
When no left branch remains, we have the smallest value.
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">smallValue</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Tree</span> a <span style="color: #D8FA3C;">-&gt;</span>  <span style="color: #D8FA3C;">Maybe</span> a
<span style="color: #ff1493;">smallValue</span> <span style="color: #D8FA3C;">Empty</span>            <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">Nothing</span>
<span style="color: #ff1493;">smallValue</span> (<span style="color: #D8FA3C;">Node</span> x <span style="color: #D8FA3C;">Empty</span> <span style="color: #FBDE2D;">_</span>) <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">Just</span> x
<span style="color: #ff1493;">smallValue</span> (<span style="color: #D8FA3C;">Node</span> <span style="color: #FBDE2D;">_</span> l <span style="color: #FBDE2D;">_</span>)     <span style="color: #D8FA3C;">=</span> smallValue l

<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> smallValue t1 <span style="color: #D8FA3C;">==</span> <span style="color: #D8FA3C;">Just</span> (head (toSortedList t1))
<span style="color: #D8FA3C;">True</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> smallValue t2 <span style="color: #D8FA3C;">==</span> <span style="color: #D8FA3C;">Just</span> (head (toSortedList t2))
<span style="color: #D8FA3C;">True</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> smallValue <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">==</span> <span style="color: #D8FA3C;">Nothing</span>
<span style="color: #D8FA3C;">True</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-5" class="outline-3">
<h3 id="sec-2-5">greatValue</h3>
<div class="outline-text-3" id="text-2-5">
<p>
Returns the greatest value in the the given Tree
Symmetrically with the previous function, we continue the computation from the right branch.
When no right branch remains, we have the greatest value.
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">greatValue</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Tree</span> a <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Maybe</span> a
<span style="color: #ff1493;">greatValue</span> <span style="color: #D8FA3C;">Empty</span>            <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">Nothing</span>
<span style="color: #ff1493;">greatValue</span> (<span style="color: #D8FA3C;">Node</span> x <span style="color: #FBDE2D;">_</span> <span style="color: #D8FA3C;">Empty</span>) <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">Just</span> x
<span style="color: #ff1493;">greatValue</span> (<span style="color: #D8FA3C;">Node</span> <span style="color: #FBDE2D;">_</span> <span style="color: #FBDE2D;">_</span> r)     <span style="color: #D8FA3C;">=</span> greatValue r

<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> greatValue t1 <span style="color: #D8FA3C;">==</span> <span style="color: #D8FA3C;">Just</span> (last (toSortedList t1))
<span style="color: #D8FA3C;">True</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> greatValue t2 <span style="color: #D8FA3C;">==</span> <span style="color: #D8FA3C;">Just</span> (last (toSortedList t2))
<span style="color: #D8FA3C;">True</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> greatValue <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">==</span> <span style="color: #D8FA3C;">Nothing</span>
<span style="color: #D8FA3C;">True</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-6" class="outline-3">
<h3 id="sec-2-6">mirror</h3>
<div class="outline-text-3" id="text-2-6">
<p>
Returns The mirror of the given Tree.
The mirror tree is a tree where all left and right branches are permuted and this recursively.
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">mirror</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Tree</span> a <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Tree</span> a
<span style="color: #ff1493;">mirror</span> <span style="color: #D8FA3C;">Empty</span>        <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">Empty</span>
<span style="color: #ff1493;">mirror</span> (<span style="color: #D8FA3C;">Node</span> x l r) <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">Node</span> x (mirror r) (mirror l)

<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> t1
<span style="color: #D8FA3C;">Node</span> 4 (<span style="color: #D8FA3C;">Node</span> 3 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>) (<span style="color: #D8FA3C;">Node</span> 7 (<span style="color: #D8FA3C;">Node</span> 5 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>) (<span style="color: #D8FA3C;">Node</span> 10 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>))
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> mirror t1
<span style="color: #D8FA3C;">Node</span> 4 (<span style="color: #D8FA3C;">Node</span> 7 (<span style="color: #D8FA3C;">Node</span> 10 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>) (<span style="color: #D8FA3C;">Node</span> 5 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>)) (<span style="color: #D8FA3C;">Node</span> 3 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>)
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> t2
<span style="color: #D8FA3C;">Node</span> 20 (<span style="color: #D8FA3C;">Node</span> 15 (<span style="color: #D8FA3C;">Node</span> 8 (<span style="color: #D8FA3C;">Node</span> 7 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>) (<span style="color: #D8FA3C;">Node</span> 11 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>)) (<span style="color: #D8FA3C;">Node</span> 18 <span style="color: #D8FA3C;">Em</span><span style="color: #dc8cc3; background-color: #383838;">pty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">)) (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 118 (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 35 (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 33 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">) (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 49 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 60 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">))) (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 166 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">))</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> mirror t2
<span style="color: #D8FA3C;">Node</span> 20 (<span style="color: #D8FA3C;">Node</span> 118 (<span style="color: #D8FA3C;">Node</span> 166 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>) (<span style="color: #D8FA3C;">Node</span> 35 (<span style="color: #D8FA3C;">Node</span> 49 (<span style="color: #D8FA3C;">Node</span> 60 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>)<span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">) (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 33 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">))) (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 15 (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 18 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">) (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 8 (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 11 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">) (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 7 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">)))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-7" class="outline-3">
<h3 id="sec-2-7">contains</h3>
<div class="outline-text-3" id="text-2-7">
<p>
Returns whether the given Tree contains the given element or not.
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">contains</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Ord</span> a <span style="color: #D8FA3C;">=&gt;</span> <span style="color: #D8FA3C;">Tree</span> a <span style="color: #D8FA3C;">-&gt;</span> a <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Bool</span>
<span style="color: #ff1493;">contains</span> <span style="color: #D8FA3C;">Empty</span> <span style="color: #FBDE2D;">_</span>        <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">False</span>
<span style="color: #ff1493;">contains</span> (<span style="color: #D8FA3C;">Node</span> x l r) y <span style="color: #D8FA3C;">=</span> <span style="color: #FBDE2D;">case</span> compare y x <span style="color: #FBDE2D;">of</span>
  <span style="color: #D8FA3C;">EQ</span> <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">True</span>
  <span style="color: #D8FA3C;">LT</span> <span style="color: #D8FA3C;">-&gt;</span> contains l y
  <span style="color: #D8FA3C;">GT</span> <span style="color: #D8FA3C;">-&gt;</span> contains r y

<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> contains t1 3
<span style="color: #D8FA3C;">True</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> contains t1 4
<span style="color: #D8FA3C;">True</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> contains t1 7
<span style="color: #D8FA3C;">True</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> contains t1 5
<span style="color: #D8FA3C;">True</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> contains t1 10
<span style="color: #D8FA3C;">True</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> contains t1 11
<span style="color: #D8FA3C;">False</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> contains t1 1
<span style="color: #D8FA3C;">False</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-8" class="outline-3">
<h3 id="sec-2-8">rightSon</h3>
<div class="outline-text-3" id="text-2-8">
<p>
Returns the right son of the given Tree.
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">rightSon</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Tree</span> a <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Tree</span> a
<span style="color: #ff1493;">rightSon</span> <span style="color: #D8FA3C;">Empty</span>        <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">Empty</span>
<span style="color: #ff1493;">rightSon</span> (<span style="color: #D8FA3C;">Node</span> <span style="color: #FBDE2D;">_</span> <span style="color: #FBDE2D;">_</span> r) <span style="color: #D8FA3C;">=</span> r

<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> t1
<span style="color: #D8FA3C;">Node</span> 4 (<span style="color: #D8FA3C;">Leaf</span> 3) (<span style="color: #D8FA3C;">Node</span> 7 (<span style="color: #D8FA3C;">Leaf</span> 5) (<span style="color: #D8FA3C;">Leaf</span> 10))
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> rightSon t1
<span style="color: #D8FA3C;">Node</span> 7 (<span style="color: #D8FA3C;">Leaf</span> 5) (<span style="color: #D8FA3C;">Leaf</span> 10)
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> t2
<span style="color: #D8FA3C;">Node</span> 20 (<span style="color: #D8FA3C;">Node</span> 15 (<span style="color: #D8FA3C;">Node</span> 8 (<span style="color: #D8FA3C;">Leaf</span> 7) (<span style="color: #D8FA3C;">Leaf</span> 11)) (<span style="color: #D8FA3C;">Leaf</span> 18)) (<span style="color: #D8FA3C;">Node</span> 118 (<span style="color: #D8FA3C;">Node</span> 35 (<span style="color: #D8FA3C;">Leaf</span><span style="color: #dc8cc3; background-color: #383838;"> 33) (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 49 (</span><span style="color: #dc8cc3; background-color: #383838;">Leaf</span><span style="color: #dc8cc3; background-color: #383838;"> 48) (</span><span style="color: #dc8cc3; background-color: #383838;">Leaf</span><span style="color: #dc8cc3; background-color: #383838;"> 60))) (</span><span style="color: #dc8cc3; background-color: #383838;">Leaf</span><span style="color: #dc8cc3; background-color: #383838;"> 166))</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> rightSon t2
<span style="color: #D8FA3C;">Node</span> 118 (<span style="color: #D8FA3C;">Node</span> 35 (<span style="color: #D8FA3C;">Leaf</span> 33) (<span style="color: #D8FA3C;">Node</span> 49 (<span style="color: #D8FA3C;">Leaf</span> 48) (<span style="color: #D8FA3C;">Leaf</span> 60))) (<span style="color: #D8FA3C;">Leaf</span> 166)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-9" class="outline-3">
<h3 id="sec-2-9">leftSon</h3>
<div class="outline-text-3" id="text-2-9">
<p>
Returns the left son of the given Tree.
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">leftSon</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Tree</span> a <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Tree</span> a
<span style="color: #ff1493;">leftSon</span> <span style="color: #D8FA3C;">Empty</span>        <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">Empty</span>
<span style="color: #ff1493;">leftSon</span> (<span style="color: #D8FA3C;">Node</span> <span style="color: #FBDE2D;">_</span> l <span style="color: #FBDE2D;">_</span>) <span style="color: #D8FA3C;">=</span> l
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-10" class="outline-3">
<h3 id="sec-2-10">insert</h3>
<div class="outline-text-3" id="text-2-10">
<p>
Insert a new ordered value into the tree.
Note that this function must preserve the Binary Search Tree properties.
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">insert</span> <span style="color: #D8FA3C;">::</span> (<span style="color: #D8FA3C;">Ord</span> a) <span style="color: #D8FA3C;">=&gt;</span> <span style="color: #D8FA3C;">Tree</span> a <span style="color: #D8FA3C;">-&gt;</span> a <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Tree</span> a
<span style="color: #ff1493;">insert</span> <span style="color: #D8FA3C;">Empty</span> x <span style="color: #D8FA3C;">=</span> leaf x
<span style="color: #ff1493;">insert</span> (<span style="color: #D8FA3C;">Node</span> x l r) y <span style="color: #D8FA3C;">=</span> <span style="color: #FBDE2D;">case</span> compare y x <span style="color: #FBDE2D;">of</span>
  <span style="color: #D8FA3C;">GT</span> <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Node</span> x l (insert r y)
  <span style="color: #FBDE2D;">_</span>  <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Node</span> x (insert l y) r

<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> insert t1 10
<span style="color: #D8FA3C;">Node</span> 4 (<span style="color: #D8FA3C;">Leaf</span> 3) (<span style="color: #D8FA3C;">Node</span> 7 (<span style="color: #D8FA3C;">Leaf</span> 5) (<span style="color: #D8FA3C;">Node</span> 10 (<span style="color: #D8FA3C;">Leaf</span> 10) <span style="color: #D8FA3C;">Empty</span>))
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> insert t2 200
<span style="color: #D8FA3C;">Node</span> 20 (<span style="color: #D8FA3C;">Node</span> 15 (<span style="color: #D8FA3C;">Node</span> 8 (<span style="color: #D8FA3C;">Leaf</span> 7) (<span style="color: #D8FA3C;">Leaf</span> 11)) (<span style="color: #D8FA3C;">Leaf</span> 18)) (<span style="color: #D8FA3C;">Node</span> 118 (<span style="color: #D8FA3C;">Node</span> 35 (<span style="color: #D8FA3C;">Leaf</span><span style="color: #dc8cc3; background-color: #383838;"> 33) (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 49 (</span><span style="color: #dc8cc3; background-color: #383838;">Leaf</span><span style="color: #dc8cc3; background-color: #383838;"> 48) (</span><span style="color: #dc8cc3; background-color: #383838;">Leaf</span><span style="color: #dc8cc3; background-color: #383838;"> 60))) (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 200 (</span><span style="color: #dc8cc3; background-color: #383838;">Leaf</span><span style="color: #dc8cc3; background-color: #383838;"> 166) </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-11" class="outline-3">
<h3 id="sec-2-11">isBSearchTree</h3>
<div class="outline-text-3" id="text-2-11">
<p>
Is this tree a binary search one?
</p>

<p>
For this, I created a utility function to retrieve the value of a node.
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">value</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Tree</span> a <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Maybe</span> a
<span style="color: #ff1493;">value</span> <span style="color: #D8FA3C;">Empty</span>        <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">Nothing</span>
<span style="color: #ff1493;">value</span> (<span style="color: #D8FA3C;">Node</span> x <span style="color: #FBDE2D;">_</span> <span style="color: #FBDE2D;">_</span>) <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">Just</span> x

<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> value (<span style="color: #D8FA3C;">Node</span> 10 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>)
<span style="color: #D8FA3C;">Just</span> 10
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> value (<span style="color: #D8FA3C;">Leaf</span> 10)
<span style="color: #D8FA3C;">Just</span> 10
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> value <span style="color: #D8FA3C;">Empty</span>
<span style="color: #D8FA3C;">Nothing</span>

<span style="color: #ff1493;">isBSearchTree</span> <span style="color: #D8FA3C;">::</span> (<span style="color: #D8FA3C;">Ord</span> a) <span style="color: #D8FA3C;">=&gt;</span> <span style="color: #D8FA3C;">Tree</span> a <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Bool</span>
<span style="color: #ff1493;">isBSearchTree</span> <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">True</span>
<span style="color: #ff1493;">isBSearchTree</span> (<span style="color: #D8FA3C;">Node</span> x l r) <span style="color: #D8FA3C;">=</span>
  <span style="color: #FBDE2D;">case</span> [value l, value r] <span style="color: #FBDE2D;">of</span>
    [<span style="color: #D8FA3C;">Nothing</span>, <span style="color: #D8FA3C;">Nothing</span>] <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">True</span>
    [<span style="color: #D8FA3C;">Nothing</span>, <span style="color: #D8FA3C;">Just</span> z]  <span style="color: #D8FA3C;">-&gt;</span> and [x <span style="color: #D8FA3C;">&lt;</span> z, isBSearchTree l, isBSearchTree r]
    [<span style="color: #D8FA3C;">Just</span> y, <span style="color: #D8FA3C;">Nothing</span>]  <span style="color: #D8FA3C;">-&gt;</span> and [y <span style="color: #D8FA3C;">&lt;=</span> x, isBSearchTree l, isBSearchTree r]
    [<span style="color: #D8FA3C;">Just</span> y, <span style="color: #D8FA3C;">Just</span> z]   <span style="color: #D8FA3C;">-&gt;</span> and [y <span style="color: #D8FA3C;">&lt;=</span> x, x <span style="color: #D8FA3C;">&lt;</span> z, isBSearchTree l, isBSearchTree r]

<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> isBSearchTree (<span style="color: #D8FA3C;">Node</span> 10 t2 t1)
<span style="color: #D8FA3C;">False</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> isBSearchTree t1
<span style="color: #D8FA3C;">True</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> isBSearchTree t2
<span style="color: #D8FA3C;">True</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> isBSearchTree (insert t2 1)
<span style="color: #D8FA3C;">True</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> isBSearchTree (insert (insert t2 1) 100)
<span style="color: #D8FA3C;">True</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-12" class="outline-3">
<h3 id="sec-2-12">deleteMax</h3>
<div class="outline-text-3" id="text-2-12">
<p>
Delete the max value of a BSTree.
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">deleteMax</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Tree</span> a <span style="color: #D8FA3C;">-&gt;</span> (<span style="color: #D8FA3C;">Maybe</span> a, <span style="color: #D8FA3C;">Tree</span> a)
<span style="color: #ff1493;">deleteMax</span> <span style="color: #D8FA3C;">Empty</span>            <span style="color: #D8FA3C;">=</span> (<span style="color: #D8FA3C;">Nothing</span>, <span style="color: #D8FA3C;">Empty</span>)
<span style="color: #ff1493;">deleteMax</span> (<span style="color: #D8FA3C;">Node</span> x <span style="color: #FBDE2D;">_</span> <span style="color: #D8FA3C;">Empty</span>) <span style="color: #D8FA3C;">=</span> (<span style="color: #D8FA3C;">Just</span> x, <span style="color: #D8FA3C;">Empty</span>)
<span style="color: #ff1493;">deleteMax</span> (<span style="color: #D8FA3C;">Node</span> x l r)     <span style="color: #D8FA3C;">=</span> <span style="color: #FBDE2D;">let</span> (y, t) <span style="color: #D8FA3C;">=</span> deleteMax r <span style="color: #FBDE2D;">in</span>
                             (y, (<span style="color: #D8FA3C;">Node</span> x l t))

<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> t1
<span style="color: #D8FA3C;">Node</span> 4 (<span style="color: #D8FA3C;">Node</span> 3 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>) (<span style="color: #D8FA3C;">Node</span> 7 (<span style="color: #D8FA3C;">Node</span> 5 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>) (<span style="color: #D8FA3C;">Node</span> 10 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>))
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> deleteMax t1
(<span style="color: #D8FA3C;">Just</span> 10,<span style="color: #D8FA3C;">Node</span> 4 (<span style="color: #D8FA3C;">Node</span> 3 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>) (<span style="color: #D8FA3C;">Node</span> 7 (<span style="color: #D8FA3C;">Node</span> 5 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>) <span style="color: #D8FA3C;">Empty</span>))
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> t2
<span style="color: #D8FA3C;">Node</span> 20 (<span style="color: #D8FA3C;">Node</span> 15 (<span style="color: #D8FA3C;">Node</span> 8 (<span style="color: #D8FA3C;">Node</span> 7 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>) (<span style="color: #D8FA3C;">Node</span> 11 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>)) (<span style="color: #D8FA3C;">Node</span> 18 <span style="color: #D8FA3C;">Em</span><span style="color: #dc8cc3; background-color: #383838;">pty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">)) (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 118 (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 35 (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 33 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">) (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 49 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 60 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">))) (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 166 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">))</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> deleteMax t2
(<span style="color: #D8FA3C;">Just</span> 166,<span style="color: #D8FA3C;">Node</span> 20 (<span style="color: #D8FA3C;">Node</span> 15 (<span style="color: #D8FA3C;">Node</span> 8 (<span style="color: #D8FA3C;">Node</span> 7 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>) (<span style="color: #D8FA3C;">Node</span> 11 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>)) (<span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 18 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">)) (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 118 (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 35 (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 33 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">) (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 49 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 60 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">))) </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-13" class="outline-3">
<h3 id="sec-2-13">deleteMin</h3>
<div class="outline-text-3" id="text-2-13">
<p>
Delete the minimal value of a BSTree.
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">deleteMin</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Tree</span> a <span style="color: #D8FA3C;">-&gt;</span> (<span style="color: #D8FA3C;">Maybe</span> a, <span style="color: #D8FA3C;">Tree</span> a)
<span style="color: #ff1493;">deleteMin</span> <span style="color: #D8FA3C;">Empty</span>            <span style="color: #D8FA3C;">=</span> (<span style="color: #D8FA3C;">Nothing</span>, <span style="color: #D8FA3C;">Empty</span>)
<span style="color: #ff1493;">deleteMin</span> (<span style="color: #D8FA3C;">Node</span> x <span style="color: #D8FA3C;">Empty</span> <span style="color: #FBDE2D;">_</span>) <span style="color: #D8FA3C;">=</span> (<span style="color: #D8FA3C;">Just</span> x, <span style="color: #D8FA3C;">Empty</span>)
<span style="color: #ff1493;">deleteMin</span> (<span style="color: #D8FA3C;">Node</span> x l r)     <span style="color: #D8FA3C;">=</span> <span style="color: #FBDE2D;">let</span> (y, t) <span style="color: #D8FA3C;">=</span> deleteMin l <span style="color: #FBDE2D;">in</span>
                             (y, (<span style="color: #D8FA3C;">Node</span> x t r))

<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> t1
<span style="color: #D8FA3C;">Node</span> 4 (<span style="color: #D8FA3C;">Node</span> 3 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>) (<span style="color: #D8FA3C;">Node</span> 7 (<span style="color: #D8FA3C;">Node</span> 5 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>) (<span style="color: #D8FA3C;">Node</span> 10 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>))
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> deleteMin t1
(<span style="color: #D8FA3C;">Just</span> 3,<span style="color: #D8FA3C;">Node</span> 4 <span style="color: #D8FA3C;">Empty</span> (<span style="color: #D8FA3C;">Node</span> 7 (<span style="color: #D8FA3C;">Node</span> 5 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>) (<span style="color: #D8FA3C;">Node</span> 10 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>)))
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> t2
<span style="color: #D8FA3C;">Node</span> 20 (<span style="color: #D8FA3C;">Node</span> 15 (<span style="color: #D8FA3C;">Node</span> 8 (<span style="color: #D8FA3C;">Node</span> 7 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>) (<span style="color: #D8FA3C;">Node</span> 11 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>)) (<span style="color: #D8FA3C;">Node</span> 18 <span style="color: #D8FA3C;">Em</span><span style="color: #dc8cc3; background-color: #383838;">pty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">)) (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 118 (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 35 (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 33 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">) (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 49 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 60 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">))) (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 166 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">))</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> deleteMin t2
(<span style="color: #D8FA3C;">Just</span> 7,<span style="color: #D8FA3C;">Node</span> 20 (<span style="color: #D8FA3C;">Node</span> 15 (<span style="color: #D8FA3C;">Node</span> 8 <span style="color: #D8FA3C;">Empty</span> (<span style="color: #D8FA3C;">Node</span> 11 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>)) (<span style="color: #D8FA3C;">Node</span> 18 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Emp</span><span style="color: #dc8cc3; background-color: #383838;">ty</span><span style="color: #dc8cc3; background-color: #383838;">)) (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 118 (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 35 (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 33 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">) (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 49 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 60 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">))) (</span><span style="color: #dc8cc3; background-color: #383838;">Node</span><span style="color: #dc8cc3; background-color: #383838;"> 166 </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Empty</span><span style="color: #dc8cc3; background-color: #383838;">)))</span>

<span style="color: #D8FA3C;">Remove</span> an element from a tree<span style="color: #D8FA3C;">.</span>
<span style="color: #D8FA3C;">To</span> remove a node, take the max element from the left tree and replace the node t<span style="color: #dc8cc3; background-color: #383838;">o be</span>
<span style="color: #ff1493;">removed</span> with this one
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-14" class="outline-3">
<h3 id="sec-2-14">Remove</h3>
<div class="outline-text-3" id="text-2-14">
<p>
Remove an element from the tree.
This must only delete the node targeted and not all the branches from the node.
Forcefully, then, when we hit the node to delete, we retrieve by convention the max from the left branch and make it the new node.
We could have also chosen to take the min value from the right node.
This way, we keep the binary search tree properties regarding the order.
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">remove</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Ord</span> a <span style="color: #D8FA3C;">=&gt;</span> <span style="color: #D8FA3C;">Tree</span> a <span style="color: #D8FA3C;">-&gt;</span> a <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Tree</span> a
<span style="color: #ff1493;">remove</span> <span style="color: #D8FA3C;">Empty</span> <span style="color: #FBDE2D;">_</span>  <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">Empty</span>
<span style="color: #ff1493;">remove</span> (<span style="color: #D8FA3C;">Node</span> x l r) y
  <span style="color: #D8FA3C;">|</span> y <span style="color: #D8FA3C;">&lt;</span> x     <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">Node</span> x (remove l y) r
  <span style="color: #D8FA3C;">|</span> y <span style="color: #D8FA3C;">&gt;</span> x     <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">Node</span> x l (remove r y)
  <span style="color: #D8FA3C;">|</span> otherwise <span style="color: #D8FA3C;">=</span> <span style="color: #FBDE2D;">case</span> deleteMax l <span style="color: #FBDE2D;">of</span>
    (<span style="color: #D8FA3C;">Just</span> z, t)  <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Node</span> z t r
    (<span style="color: #D8FA3C;">Nothing</span>, <span style="color: #FBDE2D;">_</span>) <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Empty</span>

<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> t1
<span style="color: #D8FA3C;">Node</span> 4 (<span style="color: #D8FA3C;">Node</span> 3 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>) (<span style="color: #D8FA3C;">Node</span> 7 (<span style="color: #D8FA3C;">Node</span> 5 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>) (<span style="color: #D8FA3C;">Node</span> 10 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>))
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> remove t1 4
<span style="color: #D8FA3C;">Node</span> 3 <span style="color: #D8FA3C;">Empty</span> (<span style="color: #D8FA3C;">Node</span> 7 (<span style="color: #D8FA3C;">Node</span> 5 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>) (<span style="color: #D8FA3C;">Node</span> 10 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>))
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> remove t1 3
<span style="color: #D8FA3C;">Node</span> 4 <span style="color: #D8FA3C;">Empty</span> (<span style="color: #D8FA3C;">Node</span> 7 (<span style="color: #D8FA3C;">Node</span> 5 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>) (<span style="color: #D8FA3C;">Node</span> 10 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>))
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">BinarySearchTree</span><span style="color: #D8FA3C;">&gt;</span> remove t1 7
<span style="color: #D8FA3C;">Node</span> 4 (<span style="color: #D8FA3C;">Node</span> 3 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>) (<span style="color: #D8FA3C;">Node</span> 5 <span style="color: #D8FA3C;">Empty</span> (<span style="color: #D8FA3C;">Node</span> 10 <span style="color: #D8FA3C;">Empty</span> <span style="color: #D8FA3C;">Empty</span>))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Sources</h2>
<div class="outline-text-2" id="text-3">
<p>
<a href="https://github.com/ardumont/my-haskell-lab/blob/master/src/BinarySearchTree.hs">BinarySearchTree.hs</a>
</p>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">Conclusion</h2>
<div class="outline-text-2" id="text-4">
<p>
Just the pleasure to work again with basic data structures.
</p>

<p>
Next we'll see how to implement <a href="https://en.wikipedia.org/wiki/AVL_tree">an AVL - a self-balancing binary search tree</a>.
</p>
</div>
</div>
