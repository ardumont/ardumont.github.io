---
layout: post
title: org-trello debug tools
date: 2015-09-06
categories:
- tools
- org-trello
- debug
tags:
- tools
- org-trello
- debug
author: ardumont
excerpt: org-trello debugging tools
---
<p>
Here is a list of tools I use to help in debugging/maintaining org-trello.
This could help user when they have trouble.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Repl</h2>
<div class="outline-text-2" id="text-1">
<p>
Using emacs-lisp's repl ielm:
</p>

<div class="org-src-container">

<pre class="src src-emacs">M-x ielm &lt;RET&gt;
</pre>
</div>

<p>
Set the credentials for your account:
</p>
<div class="org-src-container">

<pre class="src src-lisp"><span style="color: #8b0000;">(</span><span style="color: #FBDE2D;">let</span> <span style="color: #006400;">(</span><span style="color: #ff1493;">(</span>org-trello--user-logged-in <span style="color: #61CE3C;">"&lt;user&gt;"</span><span style="color: #ff1493;">)</span><span style="color: #006400;">)</span> <span style="color: #006400;">(</span>orgtrello-controller-load-keys<span style="color: #006400;">)</span><span style="color: #8b0000;">)</span>
</pre>
</div>
<p>
Note: Load in context the credentials from the file `~/.emacs.d/.trello/&lt;user&gt;.el`
</p>

<p>
Now execute some request to check that the connection is good:
</p>
<div class="org-src-container">

<pre class="src src-lisp">ELISP&gt; <span style="color: #8b0000;">(</span>orgtrello-query-http-trello <span style="color: #006400;">(</span>orgtrello-api-get-me<span style="color: #006400;">)</span> 'sync<span style="color: #8b0000;">)</span>
#s<span style="color: #8b0000;">(</span>hash-table size 65 test equal rehash-size 1.5 rehash-threshold 0.8 data
              <span style="color: #006400;">(</span><span style="color: #FF6400;">:username</span> <span style="color: #61CE3C;">"ardumont"</span> <span style="color: #FF6400;">:url</span> <span style="color: #61CE3C;">"https://trello.com/ardumont"</span> <span style="color: #FF6400;">:status</span> <span style="color: #61CE3C;">"</span><span style="color: #dc8cc3; background-color: #383838;">disconnected"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">:full-name</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"Antoine R. Dumont"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">:id</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"aabbccddeeffgghhiijjkk"</span><span style="color: #006400; background-color: #383838;">)</span><span style="color: #8b0000; background-color: #383838;">)</span>
</pre>
</div>

<p>
Note:
You can have a pretty good idea of org-trello's api by reading the `org-trello-api.el` file.
It's trello's api adapter.
</p>

<p>
Simpler:
</p>

<div class="org-src-container">

<pre class="src src-lisp"><span style="color: #8b0000;">(</span><span style="color: #FBDE2D;">let</span> <span style="color: #006400;">(</span><span style="color: #ff1493;">(</span>org-trello--user-logged-in <span style="color: #61CE3C;">"ardumont"</span><span style="color: #ff1493;">)</span><span style="color: #006400;">)</span>
  <span style="color: #006400;">(</span>orgtrello-controller-load-keys<span style="color: #006400;">)</span>
  <span style="color: #006400;">(</span>orgtrello-query-http-trello <span style="color: #ff1493;">(</span>orgtrello-api-get-me<span style="color: #ff1493;">)</span> 'sync<span style="color: #006400;">)</span><span style="color: #8b0000;">)</span>
</pre>
</div>
</div>

<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">Improvment on debug</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Adapt according to your need, this will help loading the org-trello context and:
</p>

<div class="org-src-container">

<pre class="src src-lisp"><span style="color: #8b0000;">(</span><span style="color: #FBDE2D;">let</span> <span style="color: #006400;">(</span><span style="color: #ff1493;">(</span>org-trello-file-to-debug <span style="color: #61CE3C;">"/home/tony/repo/perso/org-trello/TESTS-simple.o</span><span style="color: #dc8cc3; background-color: #383838;">rg"</span><span style="color: #ff1493; background-color: #383838;">)</span>
      <span style="color: #ff1493;">(</span>orgtrello-log-level orgtrello-log-trace<span style="color: #ff1493;">)</span><span style="color: #006400;">)</span>
  <span style="color: #006400;">(</span><span style="color: #FBDE2D;">with-temp-buffer</span>
    <span style="color: #ff1493;">(</span>insert-file-contents org-trello-file-to-debug<span style="color: #ff1493;">)</span>
    <span style="color: #ff1493;">(</span>org-mode<span style="color: #ff1493;">)</span>
    <span style="color: #ff1493;">(</span>org-trello-mode<span style="color: #ff1493;">)</span>
    <span style="color: #ff1493;">(</span>orgtrello-controller-load-keys<span style="color: #ff1493;">)</span>
    <span style="color: #ff1493;">(</span>-&gt; <span style="color: #ffff00;">(</span>orgtrello-buffer-board-id<span style="color: #ffff00;">)</span>
        orgtrello-api-get-full-cards
        <span style="color: #ffff00;">(</span>orgtrello-query-http-trello 'sync<span style="color: #ffff00;">)</span><span style="color: #ff1493;">)</span><span style="color: #006400;">)</span><span style="color: #8b0000;">)</span>
</pre>
</div>

<p>
<b>Note</b>: This made me <a href="https://github.com/org-trello/org-trello/issues/288">realize that org-trello could spawn an adapter library `trello-core` or `trello-lib`</a>.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Trace</h2>
<div class="outline-text-2" id="text-2">
<p>
Emacs comes with `trace-fn` function.
This can help a lot.
</p>

<p>
Identify some function you want to trace (display inputs, output), for example:
</p>
<div class="org-src-container">

<pre class="src src-lisp"><span style="color: #8b0000;">(</span>trace-function 'orgtrello-data-parse-data<span style="color: #8b0000;">)</span>
<span style="color: #8B8989; font-style: italic;">;; </span><span style="color: #8B8989; font-style: italic;">(untrace-function 'orgtrello-data-parse-data)</span>
</pre>
</div>
<p>
Note:
`orgtrello-data/parse-data` is the central function used to parse the json output of trello.
So in case of output doubt, this can be a good starting point.
</p>
</div>

<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">trace-functions</h3>
<div class="outline-text-3" id="text-2-1">
<p>
It helps a lot and you can add more functions with the following ones.
</p>

<p>
To trace mutliple ones:
</p>
<div class="org-src-container">

<pre class="src src-lisp"><span style="color: #8B8989; font-style: italic;">#+begin_src lisp</span>
<span style="color: #8b0000;">(</span><span style="color: #FBDE2D;">defun</span> <span style="color: #ff1493;">trace-functions</span> <span style="color: #006400;">(</span>fns<span style="color: #006400;">)</span>
  <span style="color: #61CE3C;">"Trace functions FNS."</span>
  <span style="color: #006400;">(</span>mapc 'trace-function fns<span style="color: #006400;">)</span><span style="color: #8b0000;">)</span>

<span style="color: #8b0000;">(</span><span style="color: #FBDE2D;">defun</span> <span style="color: #ff1493;">untrace-functions</span> <span style="color: #006400;">(</span>fns<span style="color: #006400;">)</span>
  <span style="color: #61CE3C;">"Trace functions FNS."</span>
  <span style="color: #006400;">(</span>mapc 'untrace-function fns<span style="color: #006400;">)</span><span style="color: #8b0000;">)</span>
</pre>
</div>

<p>
With sample:
</p>
<div class="org-src-container">

<pre class="src src-lisp"><span style="color: #8b0000;">(</span>trace-functions '<span style="color: #006400;">(</span>orgtrello-data/parse-data<span style="color: #006400;">)</span><span style="color: #8b0000;">)</span>
<span style="color: #8B8989; font-style: italic;">;; </span><span style="color: #8B8989; font-style: italic;">(untrace-functions '(orgtrello-data/parse-data))</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Display the content of the board's global setup</h2>
<div class="outline-text-2" id="text-3">
<p>
Inside the current org-trello buffer:
</p>

<p>
M-: (orgtrello-setup-display-current-buffer-setup!)
</p>

<p>
This will compute and return a list with the important settings.
</p>

<p>
Something like:
</p>
<div class="org-src-container">

<pre class="src src-lisp"><span style="color: #8b0000;">(</span><span style="color: #FF6400;">:users-id-name</span> #s<span style="color: #006400;">(</span>hash-table size 65 test equal rehash-size 1.5 rehash-threshol<span style="color: #dc8cc3; background-color: #383838;">d 0.8 data </span><span style="color: #ff1493; background-color: #383838;">(</span><span style="color: #dc8cc3; background-color: #383838;">"user-id0"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"orgtrello-user-antoineromaindumont"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"user-id2"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"orgtrello-user-orgmode"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"user-id3"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"orgtrello-user-ardumont"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"ardumont"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"orgtrello-user-me"</span><span style="color: #dc8cc3; background-color: #383838;"> ...</span><span style="color: #ff1493; background-color: #383838;">)</span><span style="color: #006400; background-color: #383838;">)</span>
 <span style="color: #FF6400;">:users-name-id</span> #s<span style="color: #006400;">(</span>hash-table size 65 test equal rehash-size 1.5 rehash-threshol<span style="color: #dc8cc3; background-color: #383838;">d 0.8 data </span><span style="color: #ff1493; background-color: #383838;">(</span><span style="color: #dc8cc3; background-color: #383838;">"orgtrello-user-antoineromaindumont"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"user-id0"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"orgtrello-user-orgmode"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"user-id3"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"orgtrello-user-ardumont"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"user-id1"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"orgtrello-user-me"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"ardumont"</span><span style="color: #dc8cc3; background-color: #383838;"> ...</span><span style="color: #ff1493; background-color: #383838;">)</span><span style="color: #006400; background-color: #383838;">)</span>
 <span style="color: #FF6400;">:user-logged-in</span> <span style="color: #61CE3C;">"ardumont"</span>
 <span style="color: #FF6400;">:org-keyword-trello-list-names</span> <span style="color: #006400;">(</span><span style="color: #61CE3C;">"TODO"</span> <span style="color: #61CE3C;">"IN-PROGRESS"</span> <span style="color: #61CE3C;">"DONE"</span> <span style="color: #61CE3C;">"PENDING"</span> <span style="color: #61CE3C;">"DELEGATE</span><span style="color: #dc8cc3; background-color: #383838;">D"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"FAILED"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"CANCELLED"</span><span style="color: #006400; background-color: #383838;">)</span>
 <span style="color: #FF6400;">:org-keyword-id-name</span> #s<span style="color: #006400;">(</span>hash-table size 65 test equal rehash-size 1.5 rehash-th<span style="color: #dc8cc3; background-color: #383838;">reshold 0.8 data </span><span style="color: #ff1493; background-color: #383838;">(</span><span style="color: #dc8cc3; background-color: #383838;">"todo-id"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"TODO"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"in-progress-id"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"IN-PROGRESS"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"done-id"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"DONE"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"pending-id"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"PENDING"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"delegated-id"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"DELEGATED"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"failed-id"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"FAILED"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"cancelled-id"</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">"CANCELLED"</span><span style="color: #dc8cc3; background-color: #383838;"> ...</span><span style="color: #ff1493; background-color: #383838;">)</span><span style="color: #006400; background-color: #383838;">)</span><span style="color: #8b0000; background-color: #383838;">)</span>
</pre>
</div>

<p>
This can help to see if something is amiss or not.
</p>
</div>
</div>
