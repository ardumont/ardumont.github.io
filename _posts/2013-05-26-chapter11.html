---
layout: post
title: PIH - ch11 - The countdown problem - exercises
date: 2013-05-26
categories:
- haskell
- exercises
- functional-programming
- countdown-problem
author: Antoine R. Dumont
excerpt: The countdown problem (from 'Des chiffres et des Lettres')
---
<p>
It has been a while since I read some <a href="http://www.cs.nott.ac.uk/~gmh/book.htm">programming in haskell book</a> (<a href="http://blog.pinboard.in/2013/04/the_matasano_crypto_challenges/">matasano challenges</a>, <a href="http://projecteuler.net/">euler problems</a>, <a href="http://www.4clojure.com/">4clojure problems</a>, and so on kept me busy :D).
So here it goes, the chapter 11 exercises was about the countdown problem.
</p>

<p>
Given a list of numbers and a result, find the possible operations which, when evaluated, renders such result.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">choices</h2>
<div class="outline-text-2" id="text-1">
<blockquote>
<p>
Redefine the combinatorial function <code>choices</code> using a list comprehension rather than the library functions <code>concat</code> and <code>map</code>.
</p>
</blockquote>

<p>
My first point-free implementation:
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">choices</span> <span style="color: #D8FA3C;">::</span> [a] <span style="color: #D8FA3C;">-&gt;</span> [[a]]
<span style="color: #ff1493;">choices</span> <span style="color: #D8FA3C;">=</span> (concatMap perms) <span style="color: #D8FA3C;">.</span> subs
</pre>
</div>

<p>
Using list comprehension:
</p>
<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">choices</span> <span style="color: #D8FA3C;">::</span> [a] <span style="color: #D8FA3C;">-&gt;</span> [[a]]
<span style="color: #ff1493;">choices</span> xs <span style="color: #D8FA3C;">=</span> [ p <span style="color: #D8FA3C;">|</span> s <span style="color: #D8FA3C;">&lt;-</span> subs xs, p <span style="color: #D8FA3C;">&lt;-</span> perms s]

<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> choices [1,2,3]
[<span style="color: #D8FA3C;">[]</span>,[3],[2],[2,3],[3,2],[1],[1,3],[3,1],[1,2],[2,1],[1,2,3],[2,1,3],[2,3,1],[1,3<span style="color: #dc8cc3; background-color: #383838;">,2],[3,1,2],[3,2,1]]</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> choices [1,2,3,4]
[<span style="color: #D8FA3C;">[]</span>,[4],[3],[3,4],[4,3],[2],[2,4],[4,2],[2,3],[3,2],[2,3,4],[3,2,4],[3,4,2],[2,4<span style="color: #dc8cc3; background-color: #383838;">,3],[4,2,3],[4,3,2],[1],[1,4],[4,1],[1,3],[3,1],[1,3,4],[3,1,4],[3,4,1],[1,4,3],[4,1,3],[4,3,1],[1,2],[2,1],[1,2,4],[2,1,4],[2,4,1],[1,4,2],[4,1,2],[4,2,1],[1,2,3],[2,1,3],[2,3,1],[1,3,2],[3,1,2],[3,2,1],[1,2,3,4],[2,1,3,4],[2,3,1,4],[2,3,4,1],[1,3,2,4],[3,1,2,4],[3,2,1,4],[3,2,4,1],[1,3,4,2],[3,1,4,2],[3,4,1,2],[3,4,2,1],[1,2,4,3],[2,1,4,3],[2,4,1,3],[2,4,3,1],[1,4,2,3],[4,1,2,3],[4,2,1,3],[4,2,3,1],[1,4,3,2],[4,1,3,2],[4,3,1,2],[4,3,2,1]]</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">isChoice</h2>
<div class="outline-text-2" id="text-2">
<blockquote>
<p>
Define a recursive function <code>isChoice :: Eq a ⇒ [a] → [a] → Bool</code> that decides if one list is chosen from another, without using the combinatorial functions <code>perms</code> and <code>subs</code>.
</p>

<p>
<span class="underline">Hint:</span> start by defining a function that removes the first occurrence of a value from a list.
</p>
</blockquote>

<p>
We'll follow the hint and implement the function <code>remove1</code>:
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">remove1</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Eq</span> a <span style="color: #D8FA3C;">=&gt;</span> a <span style="color: #D8FA3C;">-&gt;</span> [a] <span style="color: #D8FA3C;">-&gt;</span> [a]
<span style="color: #ff1493;">remove1</span> <span style="color: #FBDE2D;">_</span> <span style="color: #D8FA3C;">[]</span> <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">[]</span>
<span style="color: #ff1493;">remove1</span> x (y<span style="color: #D8FA3C;">:</span>ys)
  <span style="color: #D8FA3C;">|</span> x <span style="color: #D8FA3C;">==</span> y <span style="color: #D8FA3C;">=</span> ys
  <span style="color: #D8FA3C;">|</span> otherwise <span style="color: #D8FA3C;">=</span> y<span style="color: #D8FA3C;">:</span>remove1 x ys

<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> remove1 1 [3,2<span style="color: #D8FA3C;">..</span>1]
[3,2]
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> remove1 1 [9,8<span style="color: #D8FA3C;">..</span>1]
[9,8,7,6,5,4,3,2]
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> remove1 1 [9,8<span style="color: #D8FA3C;">..</span>0]
[9,8,7,6,5,4,3,2,0]
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> remove1 1 [9,8<span style="color: #D8FA3C;">..</span>0] <span style="color: #D8FA3C;">++</span> [1]
[9,8,7,6,5,4,3,2,0,1]
</pre>
</div>

<p>
Now, we can use it to help us implement the <code>isChoice</code> function
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">isChoice</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Eq</span> a <span style="color: #D8FA3C;">=&gt;</span> [a] <span style="color: #D8FA3C;">-&gt;</span> [a] <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Bool</span>
<span style="color: #ff1493;">isChoice</span> <span style="color: #D8FA3C;">[]</span> <span style="color: #FBDE2D;">_</span>     <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">True</span>
<span style="color: #ff1493;">isChoice</span> <span style="color: #FBDE2D;">_</span> <span style="color: #D8FA3C;">[]</span>     <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">False</span>
<span style="color: #ff1493;">isChoice</span> (x<span style="color: #D8FA3C;">:</span>xs) l <span style="color: #D8FA3C;">=</span> elem x l <span style="color: #D8FA3C;">&amp;&amp;</span> isChoice xs (remove1 x l)

<span style="color: #D8FA3C;">*</span>problem<span style="color: #D8FA3C;">&gt;</span> isChoice [11] [1<span style="color: #D8FA3C;">..</span>10]
<span style="color: #D8FA3C;">False</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> isChoice [2<span style="color: #D8FA3C;">..</span>3] [1<span style="color: #D8FA3C;">..</span>10]
<span style="color: #D8FA3C;">True</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> isChoice <span style="color: #D8FA3C;">[]</span> [1<span style="color: #D8FA3C;">..</span>10]
<span style="color: #D8FA3C;">True</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> isChoice <span style="color: #D8FA3C;">[]</span> <span style="color: #D8FA3C;">[]</span>
<span style="color: #D8FA3C;">True</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> isChoice [1<span style="color: #D8FA3C;">..</span>2] <span style="color: #D8FA3C;">[]</span>
<span style="color: #D8FA3C;">False</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">split</h2>
<div class="outline-text-2" id="text-3">
<blockquote>
<p>
What effect would generalising the function <code>split</code> to also return pairs containing the empty list have on the behaviour of solutions?
</p>
</blockquote>

<p>
Here is the <code>split</code> function:
</p>
<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">split</span> <span style="color: #D8FA3C;">::</span> [a] <span style="color: #D8FA3C;">-&gt;</span> [([a], [a])]
<span style="color: #ff1493;">split</span> <span style="color: #D8FA3C;">[]</span>     <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">[]</span>
<span style="color: #ff1493;">split</span> [<span style="color: #FBDE2D;">_</span>]    <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">[]</span>
<span style="color: #ff1493;">split</span> (x<span style="color: #D8FA3C;">:</span>xs) <span style="color: #D8FA3C;">=</span> ([x], xs) <span style="color: #D8FA3C;">:</span> [(x<span style="color: #D8FA3C;">:</span> ls, rs) <span style="color: #D8FA3C;">|</span> (ls, rs) <span style="color: #D8FA3C;">&lt;-</span> split xs]

<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> split [1,3,7,10,25,50]
[([1],[3,7,10,25,50]),([1,3],[7,10,25,50]),([1,3,7],[10,25,50]),([1,3,7,10],[25,<span style="color: #dc8cc3; background-color: #383838;">50]),([1,3,7,10,25],[50])]</span>
</pre>
</div>

<p>
And the client call:
</p>
<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">exprs</span> <span style="color: #D8FA3C;">::</span> [<span style="color: #D8FA3C;">Int</span>] <span style="color: #D8FA3C;">-&gt;</span> [<span style="color: #D8FA3C;">Expr</span>]
<span style="color: #ff1493;">exprs</span> <span style="color: #D8FA3C;">[]</span>  <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">[]</span>
<span style="color: #ff1493;">exprs</span> [x] <span style="color: #D8FA3C;">=</span> [<span style="color: #D8FA3C;">Val</span> x]
<span style="color: #ff1493;">exprs</span> xs  <span style="color: #D8FA3C;">=</span> [ x <span style="color: #D8FA3C;">|</span> (ls, rs) <span style="color: #D8FA3C;">&lt;-</span> split xs,
                  l        <span style="color: #D8FA3C;">&lt;-</span> exprs ls,
                  r        <span style="color: #D8FA3C;">&lt;-</span> exprs rs,
                  x        <span style="color: #D8FA3C;">&lt;-</span> combine l r]

<span style="color: #D8FA3C;">Problem</span><span style="color: #ff1493;">&gt;</span> exprs [1, 10]
[<span style="color: #D8FA3C;">App</span> <span style="color: #D8FA3C;">Mul</span> (<span style="color: #D8FA3C;">Val</span> 1) (<span style="color: #D8FA3C;">Val</span> 10),<span style="color: #D8FA3C;">App</span> <span style="color: #D8FA3C;">Add</span> (<span style="color: #D8FA3C;">Val</span> 1) (<span style="color: #D8FA3C;">Val</span> 10),<span style="color: #D8FA3C;">App</span> <span style="color: #D8FA3C;">Sub</span> (<span style="color: #D8FA3C;">Val</span> 1) (<span style="color: #D8FA3C;">Val</span> 10),<span style="color: #D8FA3C;">App</span> <span style="color: #dc8cc3; background-color: #383838;">Div</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 1) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 10)]</span>
</pre>
</div>

<p>
Adding the empty pairs to the existing result, <code>[[], l], [l, []]</code> (l is the initial list), would result in <code>exprs</code> to never reduce the size of the list when calling recursively <code>exprs</code>.
Thus breaking.
</p>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">Checks</h2>
<div class="outline-text-2" id="text-4">
<blockquote>
<p>
Using <code>choices</code>, <code>exprs</code>, and <code>eval</code>, verify that there are 33665406 possible expressions over the numbers 1, 3, 7, 10, 25, 50, and that only 4672540 of these expressions evaluate successfully.
</p>
</blockquote>

<p>
Computing all possible expressions from all possible choices from the list [1, 3, 7, 10, 25, 50] renders:
</p>
<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> length [ es <span style="color: #D8FA3C;">|</span> cs <span style="color: #D8FA3C;">&lt;-</span> choices [1,3,7,10,25,50], es <span style="color: #D8FA3C;">&lt;-</span> exprs cs]
33665406
</pre>
</div>

<p>
With the current definition of a valid expression:
</p>
<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">valid</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Op</span> <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Int</span> <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Int</span> <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Bool</span>
<span style="color: #ff1493;">valid</span> <span style="color: #D8FA3C;">Add</span> x y <span style="color: #D8FA3C;">=</span> x <span style="color: #D8FA3C;">&lt;=</span> y
<span style="color: #ff1493;">valid</span> <span style="color: #D8FA3C;">Sub</span> x y <span style="color: #D8FA3C;">=</span> x <span style="color: #D8FA3C;">&gt;</span> y
<span style="color: #ff1493;">valid</span> <span style="color: #D8FA3C;">Mul</span> x y <span style="color: #D8FA3C;">=</span> x <span style="color: #D8FA3C;">&lt;=</span> y <span style="color: #D8FA3C;">&amp;&amp;</span> x <span style="color: #D8FA3C;">/=</span> 1 <span style="color: #D8FA3C;">&amp;&amp;</span> y <span style="color: #D8FA3C;">/=</span> 1
<span style="color: #ff1493;">valid</span> <span style="color: #D8FA3C;">Div</span> x y <span style="color: #D8FA3C;">=</span> y <span style="color: #D8FA3C;">/=</span> 1 <span style="color: #D8FA3C;">&amp;&amp;</span> x <span style="color: #D8FA3C;">`mod`</span> y <span style="color: #D8FA3C;">==</span> 0
</pre>
</div>

<p>
Evaluating those valid expressions renders:
</p>
<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> length [ es <span style="color: #D8FA3C;">|</span> cs <span style="color: #D8FA3C;">&lt;-</span> choices [1,3,7,10,25,50], es <span style="color: #D8FA3C;">&lt;-</span> exprs cs, eval es <span style="color: #dc8cc3; background-color: #383838;">/=</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">[]</span><span style="color: #dc8cc3; background-color: #383838;">]</span>
245644
</pre>
</div>

<p>
which differs from the problem.
</p>

<p>
Using the basic implementation for <code>valid</code>, we obtain indeed the same number.
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">valid</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Op</span> <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Int</span> <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Int</span> <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Bool</span>
<span style="color: #ff1493;">valid</span> <span style="color: #D8FA3C;">Add</span> <span style="color: #FBDE2D;">_</span> <span style="color: #FBDE2D;">_</span> <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">True</span>
<span style="color: #ff1493;">valid</span> <span style="color: #D8FA3C;">Sub</span> x y <span style="color: #D8FA3C;">=</span> x <span style="color: #D8FA3C;">&gt;</span> y
<span style="color: #ff1493;">valid</span> <span style="color: #D8FA3C;">Mul</span> <span style="color: #FBDE2D;">_</span> <span style="color: #FBDE2D;">_</span> <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">True</span>
<span style="color: #ff1493;">valid</span> <span style="color: #D8FA3C;">Div</span> x y <span style="color: #D8FA3C;">=</span> y <span style="color: #D8FA3C;">/=</span> 0 <span style="color: #D8FA3C;">&amp;&amp;</span> x <span style="color: #D8FA3C;">`mod`</span> y <span style="color: #D8FA3C;">==</span> 0

<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> length [ es <span style="color: #D8FA3C;">|</span> cs <span style="color: #D8FA3C;">&lt;-</span> choices [1,3,7,10,25,50], es <span style="color: #D8FA3C;">&lt;-</span> exprs cs, eval es <span style="color: #dc8cc3; background-color: #383838;">/=</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">[]</span><span style="color: #dc8cc3; background-color: #383838;">]</span>
4672540
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">Checks 2</h2>
<div class="outline-text-2" id="text-5">
<blockquote>
<p>
Similarly, verify that the number of expressions that evaluate successfully increases to 10839369 if the numeric domain is generalised to arbitrary integers.
</p>

<p>
<span class="underline">Hint:</span> modify the definition of valid.
</p>
</blockquote>

<p>
Now modifying the signature of valid to permit no particular filter on those numbers:
</p>
<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">valid</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Op</span> <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Int</span> <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Int</span> <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Bool</span>
<span style="color: #ff1493;">valid</span> <span style="color: #D8FA3C;">Add</span> <span style="color: #FBDE2D;">_</span> <span style="color: #FBDE2D;">_</span> <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">True</span>
<span style="color: #ff1493;">valid</span> <span style="color: #D8FA3C;">Sub</span> <span style="color: #FBDE2D;">_</span> <span style="color: #FBDE2D;">_</span> <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">True</span>
<span style="color: #ff1493;">valid</span> <span style="color: #D8FA3C;">Mul</span> <span style="color: #FBDE2D;">_</span> <span style="color: #FBDE2D;">_</span> <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">True</span>
<span style="color: #ff1493;">valid</span> <span style="color: #D8FA3C;">Div</span> x y <span style="color: #D8FA3C;">=</span> y <span style="color: #D8FA3C;">/=</span> 0 <span style="color: #D8FA3C;">&amp;&amp;</span> x <span style="color: #D8FA3C;">`mod`</span> y <span style="color: #D8FA3C;">==</span> 0
</pre>
</div>

<p>
We obtain:
</p>
<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> length [ es <span style="color: #D8FA3C;">|</span> cs <span style="color: #D8FA3C;">&lt;-</span> choices [1,3,7,10,25,50], es <span style="color: #D8FA3C;">&lt;-</span> exprs cs, eval es <span style="color: #dc8cc3; background-color: #383838;">/=</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">[]</span><span style="color: #dc8cc3; background-color: #383838;">]</span>
10839369
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">Modifications</h2>
<div class="outline-text-2" id="text-6">
<blockquote>
<p>
Modify the final program to:
</p>
<ul class="org-ul">
<li>allow the use of exponentiation in expressions;
</li>
<li>produce the nearest solutions if no exact solution is possible;
</li>
<li>order the solutions using a suitable measure of simplicity.
</li>
</ul>
</blockquote>

<p>
We first need to add the exp operation in the data Op:
</p>
<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #8B8989; font-style: italic;">-- </span><span style="color: #8B8989; font-style: italic;">operation</span>
<span style="color: #FBDE2D;">data</span> <span style="color: #D8FA3C;">Op</span> <span style="color: #D8FA3C;">=</span> <span style="color: #D8FA3C;">Add</span> <span style="color: #D8FA3C;">|</span> <span style="color: #D8FA3C;">Sub</span> <span style="color: #D8FA3C;">|</span> <span style="color: #D8FA3C;">Mul</span> <span style="color: #D8FA3C;">|</span> <span style="color: #D8FA3C;">Div</span> <span style="color: #D8FA3C;">|</span> <span style="color: #D8FA3C;">Exp</span> <span style="color: #FBDE2D;">deriving</span> (<span style="color: #D8FA3C;">Show</span>)
</pre>
</div>

<p>
Then update the definition of valid expression.
We will follow the same guideline, that is no negative exponent and as <code>a ^ 1 =</code> a=, we will refuse any exponent 1.
Thus the following definition:
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">valid</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Op</span> <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Int</span> <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Int</span> <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Bool</span>
<span style="color: #ff1493;">valid</span> <span style="color: #D8FA3C;">Add</span> x y <span style="color: #D8FA3C;">=</span> x <span style="color: #D8FA3C;">&lt;=</span> y
<span style="color: #ff1493;">valid</span> <span style="color: #D8FA3C;">Sub</span> x y <span style="color: #D8FA3C;">=</span> x <span style="color: #D8FA3C;">&gt;</span> y
<span style="color: #ff1493;">valid</span> <span style="color: #D8FA3C;">Mul</span> x y <span style="color: #D8FA3C;">=</span> x <span style="color: #D8FA3C;">&lt;=</span> y <span style="color: #D8FA3C;">&amp;&amp;</span> x <span style="color: #D8FA3C;">/=</span> 1 <span style="color: #D8FA3C;">&amp;&amp;</span> y <span style="color: #D8FA3C;">/=</span> 1
<span style="color: #ff1493;">valid</span> <span style="color: #D8FA3C;">Div</span> x y <span style="color: #D8FA3C;">=</span> y <span style="color: #D8FA3C;">&gt;</span> 1 <span style="color: #D8FA3C;">&amp;&amp;</span> x <span style="color: #D8FA3C;">`mod`</span> y <span style="color: #D8FA3C;">==</span> 0
<span style="color: #ff1493;">valid</span> <span style="color: #D8FA3C;">Exp</span> <span style="color: #FBDE2D;">_</span> y <span style="color: #D8FA3C;">=</span> y <span style="color: #D8FA3C;">==</span> 0 <span style="color: #D8FA3C;">||</span> y <span style="color: #D8FA3C;">&gt;</span> 1

<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> valid <span style="color: #D8FA3C;">Exp</span> 10 2
<span style="color: #D8FA3C;">True</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> valid <span style="color: #D8FA3C;">Exp</span> 10 (<span style="color: #D8FA3C;">-</span>1)
<span style="color: #D8FA3C;">False</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> valid <span style="color: #D8FA3C;">Exp</span> 10 1
<span style="color: #D8FA3C;">False</span>
</pre>
</div>

<p>
Then updating the <code>apply</code> function to add the evaluation part of the Exp operation:
</p>
<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">apply</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Op</span> <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Int</span> <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Int</span> <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">Int</span>
<span style="color: #ff1493;">apply</span> <span style="color: #D8FA3C;">Add</span> x y <span style="color: #D8FA3C;">=</span> x <span style="color: #D8FA3C;">+</span> y
<span style="color: #ff1493;">apply</span> <span style="color: #D8FA3C;">Sub</span> x y <span style="color: #D8FA3C;">=</span> x <span style="color: #D8FA3C;">-</span> y
<span style="color: #ff1493;">apply</span> <span style="color: #D8FA3C;">Mul</span> x y <span style="color: #D8FA3C;">=</span> x <span style="color: #D8FA3C;">*</span> y
<span style="color: #ff1493;">apply</span> <span style="color: #D8FA3C;">Div</span> x y <span style="color: #D8FA3C;">=</span> x <span style="color: #D8FA3C;">`div`</span> y
<span style="color: #ff1493;">apply</span> <span style="color: #D8FA3C;">Exp</span> x y <span style="color: #D8FA3C;">=</span> x <span style="color: #D8FA3C;">^</span> y

<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> apply <span style="color: #D8FA3C;">Exp</span> 10 2
100
</pre>
</div>

<p>
At last, updating the ops function to add Exp to the possible operations:
</p>
<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">ops</span> <span style="color: #D8FA3C;">::</span> [<span style="color: #D8FA3C;">Op</span>]
<span style="color: #ff1493;">ops</span> <span style="color: #D8FA3C;">=</span> [<span style="color: #D8FA3C;">Mul</span>, <span style="color: #D8FA3C;">Add</span>, <span style="color: #D8FA3C;">Sub</span>, <span style="color: #D8FA3C;">Div</span>, <span style="color: #D8FA3C;">Exp</span>]
</pre>
</div>

<p>
Now everything is good to be able to compute possible expressions.
For example, with 1, 2, 10, and a solution 100, we only have the expression 10 ^ 2:
</p>
<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> solutions' [1,2,10] 100
[<span style="color: #D8FA3C;">App</span> <span style="color: #D8FA3C;">Exp</span> (<span style="color: #D8FA3C;">Val</span> 10) (<span style="color: #D8FA3C;">Val</span> 2)]
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7">QuickCheck</h2>
<div class="outline-text-2" id="text-7">
<p>
We will use a little bit of quickCheck to ensure everything is still ok.
</p>

<p>
First we need to deal with the property we want to ensure is ok.
This property is the fact that every expression generated from the list [1, 3, 7, 10, 25, 50], for a given n, when evaluated, indeed renders [n].
</p>

<p>
For this, we will need a generator of not too big interval [1..1000] seems good.
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">prop_solution</span> <span style="color: #D8FA3C;">=</span> forAll (elements [1<span style="color: #D8FA3C;">..</span>1000]) <span style="color: #D8FA3C;">$</span> <span style="color: #D8FA3C;">\</span>n <span style="color: #D8FA3C;">-&gt;</span> all (<span style="color: #D8FA3C;">\</span>x <span style="color: #D8FA3C;">-&gt;</span> eval x <span style="color: #D8FA3C;">==</span> [n]) (s<span style="color: #dc8cc3; background-color: #383838;">olutions' [1, 3, 7, 10, 25, 50] n)</span>
</pre>
</div>

<p>
Then, as this treatment is heavy (the number of expressions can be quite huge), we will limit ourselves to only 2 passing tests (feel free to increase).
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">deepCheck</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">Testable</span> prop <span style="color: #D8FA3C;">=&gt;</span> prop <span style="color: #D8FA3C;">-&gt;</span> <span style="color: #D8FA3C;">IO</span> <span style="color: #D8FA3C;">()</span>
<span style="color: #ff1493;">deepCheck</span> p <span style="color: #D8FA3C;">=</span> verboseCheckWith stdArgs { maxSuccess <span style="color: #D8FA3C;">=</span> 2 } p
</pre>
</div>

<p>
Now we can run the tests.
</p>
<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #ff1493;">test</span> <span style="color: #D8FA3C;">::</span> <span style="color: #D8FA3C;">IO</span> <span style="color: #D8FA3C;">()</span>
<span style="color: #ff1493;">test</span> <span style="color: #D8FA3C;">=</span> <span style="color: #FBDE2D;">do</span>
  deepCheck prop_solution

<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> test
<span style="color: #D8FA3C;">Passed</span><span style="color: #ff1493;">:</span>
852
<span style="color: #D8FA3C;">Passed</span><span style="color: #ff1493;">:</span>
332
<span style="color: #D8FA3C;">+++</span> <span style="color: #D8FA3C;">OK</span>, passed 2 tests<span style="color: #D8FA3C;">.</span>
</pre>
</div>

<p>
QuickCheck gave us the number it elected, for the curious, we can see those results:
</p>

<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> solutions' [1, 3, 7, 10, 25, 50] 852
[<span style="color: #D8FA3C;">App</span> <span style="color: #D8FA3C;">Sub</span> (<span style="color: #D8FA3C;">App</span> <span style="color: #D8FA3C;">Mul</span> (<span style="color: #D8FA3C;">App</span> <span style="color: #D8FA3C;">Sub</span> (<span style="color: #D8FA3C;">Val</span> 25) (<span style="color: #D8FA3C;">Val</span> 10)) (<span style="color: #D8FA3C;">App</span> <span style="color: #D8FA3C;">Add</span> (<span style="color: #D8FA3C;">Val</span> 7) (<span style="color: #D8FA3C;">Val</span> 50))) (<span style="color: #D8FA3C;">Val</span> 3<span style="color: #dc8cc3; background-color: #383838;">),</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Add</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Sub</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 3) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 1)) (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Mul</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Add</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 7) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 10)) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 50)),</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Add</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 3) (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Sub</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Mul</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Add</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 7) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 10)) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 50)) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 1)),</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Sub</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Add</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 3) (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Mul</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Add</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 7) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 10)) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 50))) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 1),</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Sub</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Mul</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Add</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 1) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 10)) (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Add</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 7) (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Mul</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 3) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 25)))) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 50),</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Add</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Sub</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 3) (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Exp</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 1) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 25))) (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Mul</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Add</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 7) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 10)) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 50)),</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Sub</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Mul</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Sub</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 25) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 7)) (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Sub</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 50) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 1))) (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Mul</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 3) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 10)),</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Add</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 3) (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Sub</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Mul</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Add</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 7) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 10)) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 50)) (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Exp</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 1) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 25))),</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Sub</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Add</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 3) (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Mul</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Add</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 7) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 10)) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 50))) (</span><span style="color: #dc8cc3; background-color: #383838;">App</span><span style="color: #dc8cc3; background-color: #383838;"> </span><span style="color: #dc8cc3; background-color: #383838;">Exp</span><span style="color: #dc8cc3; background-color: #383838;"> (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 1) (</span><span style="color: #dc8cc3; background-color: #383838;">Val</span><span style="color: #dc8cc3; background-color: #383838;"> 25))]</span>
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> length <span style="color: #D8FA3C;">$</span> solutions' [1, 3, 7, 10, 25, 50] 852
9
<span style="color: #D8FA3C;">*</span><span style="color: #D8FA3C;">Problem</span><span style="color: #D8FA3C;">&gt;</span> length <span style="color: #D8FA3C;">$</span> solutions' [1, 3, 7, 10, 25, 50] 332
145
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8">Source</h2>
<div class="outline-text-2" id="text-8">
<p>
<a href="https://github.com/ardumont/haskell-lab/blob/master/src/countdown/problem.hs">countdown/problem.hs</a>
</p>
</div>
</div>
