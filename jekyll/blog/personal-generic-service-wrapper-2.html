<p>
In a <a href="http://adumont.fr/blog/personal-generic-service-wrapper/">previous article</a>, I presented a generic service wrapper.
This script was limited in one point, we could not wrap call to command with arguments.
</p>

<p>
I suggested that we could make an evolution to deal with it (without proposing one at a time).
</p>

<p>
A simple but yet elegant approach is to switch arguments position:
</p>
<ul class="org-ul">
<li>first one becomes the action we want the service command to execute (start, stop, etc&#x2026;)
</li>
<li>second one becomes the application's name we deal with (to stop the application we want simply its name, for example <code>stalonetray</code>, <code>emacs</code>, etc&#x2026;)
</li>
<li>the remaining arguments are the actual arguments for the full command. We simply transit them to the original command when we need to start the process (for example <code>-t --window-type=normal</code>, <code>--daemon</code>, etc&#x2026;)
</li>
</ul>

<p>
Here it goes:
</p>

<div class="org-src-container">

<pre class="src src-sh">#!/bin/bash
# Use: $0 {start|stop|restart|status} &lt;APP&gt;
# Generic Service Wrapper
# Example:
# $0 {start|stop|status|restart} &lt;htop|nm-applet|some-personal-script&gt;

### functions

# Application that this service wraps
ACTION=$1
APP=$2
shift
shift
CMD="$APP $*"

# Send a signal to the nm-applet pid (KILL to kill, 0 to know if it's alive)
app-send() {
    SIG=$1
    mypid=$(pidof $APP)
    [ -z "$mypid" ] &amp;&amp; exit 1   # no pid so not running
    kill -$SIG $mypid &amp;&amp; exit 0 # if pid exists and the process exists, will return 0
    exit 1 # otherwise problem
}

# Stop application
app-stop() {
    $(app-send KILL)
}

# Start application
app-start() {
    $CMD
}

# status
app-status() {
    $(app-send 0)
    ( [ $? = 0 ] &amp;&amp; echo "$APP is running!" ) || echo "$APP is not running!"
}

### run

case "$ACTION" in
    start)
	app-start
	app-status
	;;

    stop)
	app-stop
	app-status
	;;

    restart)
	app-stop
	app-start
	;;

    status)
	app-status
	;;

    *)
	echo "Usage: $0 {start|stop|restart|status} &lt;APP&gt;" &gt;&amp;2
	exit 1
	;;
esac
</pre>
</div>

<p>
<a href="https://github.com/ardumont/sh/blob/master/service/service.sh">Source</a>
</p>

<p>
Usage example:
</p>

<ul class="org-ul">
<li>Restarting the daemon emacs
</li>
</ul>
<div class="org-src-container">

<pre class="src src-sh">~/bin/service/service.sh restart emacs --daemon
</pre>
</div>

<ul class="org-ul">
<li>Restarting stalonetray
</li>
</ul>
<div class="org-src-container">

<pre class="src src-sh">~/bin/service/service.sh restart stalonetray -t --window-type=normal
</pre>
</div>
