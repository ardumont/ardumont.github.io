<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Setup the asus zenbook</title>
<!-- 2014-12-02 Tue 00:24 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Antoine R. Dumont" />
<meta  name="description" content="Small steps to setup my asus zenbook"
 />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" href="./other/style.css" type="text/css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Setup the asus zenbook</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">First backup</a></li>
<li><a href="#sec-2">Update <b>/etc/fstab</b></a>
<ul>
<li><a href="#sec-2-1">Remove writes</a></li>
<li><a href="#sec-2-2">/tmp in ram</a></li>
<li><a href="#sec-2-3">Reboot</a></li>
</ul>
</li>
<li><a href="#sec-3">scheduler</a>
<ul>
<li><a href="#sec-3-1">Check the possibilities of your hardware</a></li>
<li><a href="#sec-3-2">Make them permanent</a></li>
<li><a href="#sec-3-3">Reboot</a></li>
</ul>
</li>
<li><a href="#sec-4">Grub setup</a>
<ul>
<li><a href="#sec-4-1">New options</a>
<ul>
<li><a href="#sec-4-1-1"><code>rootfstype=ext4</code></a></li>
<li><a href="#sec-4-1-2"><code>pcie_aspm=force</code></a></li>
<li><a href="#sec-4-1-3"><code>drm.vblankoffdelay=1 i915.semaphores=1</code></a></li>
<li><a href="#sec-4-1-4"><code>nmi_watchdog=0</code></a></li>
</ul>
</li>
<li><a href="#sec-4-2">Final Result</a></li>
<li><a href="#sec-4-3">Update grub</a></li>
<li><a href="#sec-4-4">Reboot</a></li>
</ul>
</li>
<li><a href="#sec-5">Gnome bindings (optional)</a></li>
<li><a href="#sec-6">Reboot</a></li>
</ul>
</div>
</div>
<p>
Hi,
</p>

<p>
I finally succeeded in making my choice about a new pc - the asus zenbook (core i5, 24gb ssd, 500 gb, 4go ram&#x2026;).
</p>

<p>
After having troubles (dark stories of bios/boot manager/partitioning system hell) installing GNU/Linux (linux mint 13 &amp; 14), it now works like a charm.
Long story short, to keep the install system simple, now you must use x86<sub>64</sub> for x86<sub>64</sub> and x86 for x86 (at least, it's my conclusion for ubuntu/linuxmint system).
</p>

<p>
Anyway, the goal of this article is to show the tweaks for setuping the asus zenbook on an ubuntu based (maybe debian based).
</p>

<ul class="org-ul">
<li><b>Sources</b>
<ul class="org-ul">
<li><a href="http://www.howtogeek.com/62761/how-to-tweak-your-ssd-in-ubuntu-for-better-performance/">http://www.howtogeek.com/62761/how-to-tweak-your-ssd-in-ubuntu-for-better-performance/</a>
</li>
<li><a href="https://help.ubuntu.com/community/AsusZenbookPrime">https://help.ubuntu.com/community/AsusZenbookPrime</a>
</li>
</ul>
</li>

<li><b>Advices</b>
</li>
</ul>
<p>
Reboot after each system modifications (regarding file system or boot setup options).
</p>

<p>
Simply to be able to tell which modification broke the machine.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">First backup</h2>
<div class="outline-text-2" id="text-1">
<p>
Backup the current fstab to avoid any errors.
</p>

<div class="org-src-container">

<pre class="src src-sh">sudo cp /etc/fstab /etc/fstab.ori
</pre>
</div>

<p>
(No need to reboot here)
</p>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Update <b>/etc/fstab</b></h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">Remove writes</h3>
<div class="outline-text-3" id="text-2-1">
<p>
From the man `mount` page:
</p>

<div class="org-src-container">

<pre class="src src-man">noatime
       Do not update inode access times on this filesystem (e.g., for faster access on the news spool to speed up news servers).
nodiratime
       Do not update directory inode access times on this filesystem.
discard/nodiscard
       Controls  whether  ext4  should issue discard/TRIM commands to the underlying block device when blocks are freed.  This is useful for SSD devices and
       sparse/thinly-provisioned LUNs, but it is off by default until sufficient testing has been done.
</pre>
</div>

<p>
The asus zenkook owns 2 hdd, one SSD and one SATA.
The os is installed on the SSD one.
</p>

<p>
Adding <b>noatime</b> to avoid excessed writing about access times.
</p>

<div class="org-src-container">

<pre class="src src-fstab">UUID=xyz-blbl-abcd-dcba-xyz /   ext4    discard,noatime,errors=remount-ro 0 1
</pre>
</div>

<p>
<b>Note</b>
<b>noatime</b> is a superset of <b>nodiratime</b> so only <b>noatime</b> is need.
</p>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">/tmp in ram</h3>
<div class="outline-text-3" id="text-2-2">
<p>
To minimize the writing in the ssd, it may be good to mount /tmp in ram.
</p>

<div class="org-src-container">

<pre class="src src-sh">tmpfs /tmp tmpfs defaults,noatime,mode=1777 0 0
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3">Reboot</h3>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">scheduler</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">Check the possibilities of your hardware</h3>
<div class="outline-text-3" id="text-3-1">
<p>
if your ssd is /dev/sdb:
</p>

<div class="org-src-container">

<pre class="src src-sh">cat /sys/block/sdb/queue/scheduler
noop deadline [cfq]
</pre>
</div>

<p>
We can use <a href="http://en.wikipedia.org/wiki/Deadline_scheduler">deadline</a> over <a href="http://en.wikipedia.org/wiki/CFQ">cfq</a>.
</p>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">Make them permanent</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Add those line to <b>/etc/rc.local</b>
</p>

<div class="org-src-container">

<pre class="src src-sh">echo deadline &gt; /sys/block/sdb/queue/scheduler
echo 1 &gt; /sys/block/sdb/queue/iosched/fifo_batch
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3">Reboot</h3>
</div>
</div>
<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">Grub setup</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1">New options</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Add this to <b>/etc/default/grub</b>
</p>
</div>

<div id="outline-container-sec-4-1-1" class="outline-4">
<h4 id="sec-4-1-1"><code>rootfstype=ext4</code></h4>
<div class="outline-text-4" id="text-4-1-1">
<p>
To stress that <b>/root</b> in in a ext4 partition.
</p>
</div>
</div>

<div id="outline-container-sec-4-1-2" class="outline-4">
<h4 id="sec-4-1-2"><code>pcie_aspm=force</code></h4>
<div class="outline-text-4" id="text-4-1-2">
<p>
To diminish the loss of power during idle time.
</p>
</div>
</div>

<div id="outline-container-sec-4-1-3" class="outline-4">
<h4 id="sec-4-1-3"><code>drm.vblankoffdelay=1 i915.semaphores=1</code></h4>
<div class="outline-text-4" id="text-4-1-3">
<p>
To save power.
</p>
</div>
</div>

<div id="outline-container-sec-4-1-4" class="outline-4">
<h4 id="sec-4-1-4"><code>nmi_watchdog=0</code></h4>
<div class="outline-text-4" id="text-4-1-4">
<p>
Deactivate the watchdog.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2">Final Result</h3>
<div class="outline-text-3" id="text-4-2">
<div class="org-src-container">

<pre class="src src-sh">GRUB_CMDLINE_LINUX_DEFAULT="quiet splash rootfstype=ext4 pcie_aspm=force drm.vblankoffdelay=1 i915.semaphores=1 nmi_watchdog=0"
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3">Update grub</h3>
<div class="outline-text-3" id="text-4-3">
<div class="org-src-container">

<pre class="src src-sh">sudo update-grub
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-4" class="outline-3">
<h3 id="sec-4-4">Reboot</h3>
</div>
</div>
<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">Gnome bindings (optional)</h2>
<div class="outline-text-2" id="text-5">
<p>
Those one does not entirely work, you may skip.
</p>

<div class="org-src-container">

<pre class="src src-sh">sudo aptitude install cheese
gconftool-2 -s /desktop/gnome/keybindings/custom0/name -t string 'Web Cam'
gconftool-2 -s /desktop/gnome/keybindings/custom0/binding -t string 'XF86WebCam'
gconftool-2 -s /desktop/gnome/keybindings/custom0/action -t string 'cheese'
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">Reboot</h2>
<div class="outline-text-2" id="text-6">
<p>
Now enjoy.
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: <span class="timestamp-wrapper"><span class="timestamp">[2012-12-22 Sat 14:20]</span></span></p>
<p class="author">Author: Antoine R. Dumont</p>
<p class="date">Created: 2014-12-02 Tue 00:24</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.4.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
